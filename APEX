//сканер на проблеми
https://security.secure.force.com/security/tools/forcecom/scanner#

Все про apex
https://developer.salesforce.com/page/Apex_Intro
https://www.tutorialspoint.com/apex/apex_data_types.htm
Sertifications
https://quizlet.com/116767571/salesforce-app-builder-certification-flash-cards/

Map<String, List<Schedule__c>> scheduleRecordsMap = new Map<String, List<Schedule__c>>();

//витягнути філди з філдсету обєкту
private static final List<Schema.FieldSetMember> ACCOUNT_FIELD_SET_FIELDS = ObjectType.Account.FieldSets.Time_Invoice_Item.getFields();



//Attachments - завантажені документи
https://trailhead.salesforce.com/content/learn/projects/salesforce_developer_workshop/creating_lc_with_apex_controller
attachments are stored as ContentDocuments
public static void updatePicturePath(String recId){
        //In Lightning Experience, Attachments are stored in ContentDocuments
        ContentDocumentLink docLink = [SELECT ContentDocumentId FROM ContentDocumentLink WHERE LinkedEntityId = :recId order by Id desc Limit 1];
        //ContentVersion Id uniquely identifies the attachment
		ContentVersion ver = [SELECT Id FROM ContentVersion Where ContentDocumentId = :docLink.ContentDocumentId];
        //Update the Picture_Path field with the url of the image
        Speaker__c speaker = [SELECT Id FROM Speaker__c WHERE Id = :recId];
        speaker.Picture_Path__c = '/sfc/servlet.shepherd/version/download/'+ ver.Id;
        upsert speaker;
}
    
    
//apex show massage in Visual Force
https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_pages_message.htm
ApexPages.addMessage();
ApexPages.addMessage(new ApexPages.Message(ApexPages.Severity.WARNING,'Some Text'));
ApexPages.addMessage(new ApexPages.Message(ApexPages.Severity.ERROR, e.getMessage()));
<apex:pageMessages />

//селект стрінгою
Database.query('SELECT Name FROW Account');


//fill map by keys(quoteLineItem Payment Type) and values (Schedule__c records)
        Map<String, List<Schedule__c>> scheduleRecordsMap = new Map<String, List<Schedule__c>>();
        for(Schedule__c scheduleRelatedRecord : scheduleRelatedRecords) {
            if(scheduleRecordsMap.containsKey(scheduleRelatedRecord.Option_Item__r.Payment_Type__c)){
                scheduleRecordsMap.get(scheduleRelatedRecord.Option_Item__r.Payment_Type__c).add(scheduleRelatedRecord);
            } else {
                scheduleRecordsMap.put(scheduleRelatedRecord.Option_Item__r.Payment_Type__c, new List<Schedule__c>{scheduleRelatedRecord});
            }
        }


**********************
for(String keyInMap : myMap.keySet()) {}
for(sObject object : myMap.values()){}

**********************
Get values of picklist
https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_methods_system_fields_describe.htm

**********************
//get org url
String url = URL.getSalesforceBaseUrl().toExternalForm();

**********************
//Page reference
//взяти параметир з url
String redirect = ApexPages.currentPage().getParameters().get('redirect');

//запхати параметир в url
PageReference pageRef = new PageReference('/apex/EditQuotePage?newId='+thisQuote.Id);
pageRef.setRedirect(true);
pageRef.getParameters().put('redirect', 'true');


**********************
Visualforce page
**********************
//коли пишем екстеншин до standart controller
<apex:page standardController="case" extensions="cls_CaseMilestones">
public cls_CaseMilestones(ApexPages.StandardController stdController){}

//test до екстеншина
/-сетаємо нашу сторінку в pagereference
PageReference pageRef = Page.CaseMilestones;
Test.setCurrentPage(pageRef);
ApexPages.currentPage().getParameters().put('id', testCase.id);

/-викликаємо на конструктор
ApexPages.StandardController sc = new ApexPages.StandardController(testCase);                                
cls_CaseMilestones controller = new cls_CaseMilestones(sc);


************************
//взнати які юзери в Queue
Lead lead = [SELECT OwnerId, Owner.Type FROM Lead WHERE Company = 'TechMagic'];
if(lead.Owner.Type == 'Queue'){
    List<GroupMember> gm = [SELECT UserOrGroupId  FROM GroupMember WHERE GroupId = :lead.OwnerId];
    for(GroupMember g : gm){
        System.debug(g.Id.getSObjectType() + '-' + g.UserOrGroupId.getSObjectType());
    }
    List<User> u = [SELECT Name FROM User WHERE Id = :gm[0].UserOrGroupId];
    System.debug(u);
}


*************************
//get fields type
Map<String, Schema.SObjectField> cf = Schema.SObjectType.Account.fields.getMap();
List<Map<String, String>> fieldsTypes = new List<Map<String, String>>();
for(String field : cf.keySet()) {
    Schema.SObjectField f = cf.get(field);
    Schema.DisplayType fieldType = f.getDescribe().getType();
    System.debug(f + ' => ' + field + ' => ' + fieldType);
    Map<String, String> fieldTypeMap = new Map<String, String>{String.valueOf(field) => String.valueOf(fieldType)};
    fieldsTypes.add(fieldTypeMap);
}
System.debug(JSON.serialize(fieldsTypes));

//get fields and fields type from field set API named Heroku_App_Fields sObject Case
List<Schema.FieldSetMember> allFields = Schema.SObjectType.Case.fieldSets.Heroku_App_Fields.getFields();
List<Map<String, String>> fieldsTypes = new List<Map<String, String>>();
for(Schema.FieldSetMember f : allFields){
    String field = String.valueOf(f.getFieldPath()).toLowerCase();
    String fieldType = String.valueOf(f.getType()).toLowerCase();
    Map<String, String> fieldTypeMap = new Map<String, String>{field => fieldType};
    fieldsTypes.add(fieldTypeMap);
    
    System.debug('Name=> ' + field + ' **** Type=> ' + fieldType);
}
System.debug(JSON.serialize(fieldsTypes));

*************************
//Custom settings
String token = ServiceTokens__c.getValues('ProjectServiceToken').Token__c;


*************************
//time difference
Case c = [SELECT CreatedDate, LastModifiedDate  FROM Case LIMIT 1];
//System.debug(DateTime.newInstance(c.CreatedDate));
//System.debug(datetime.now() - c.CreatedDate);
Long now = datetime.now().getTime();
Long created = c.CreatedDate.getTime();
Long modified = c.LastModifiedDate.getTime();

Long milliseconds = now - modified;
Long seconds = milliseconds / 1000;
Long minutes = seconds / 60;
Long hours = minutes / 60;
Long days = hours / 24;

System.debug(days);

